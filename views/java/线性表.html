<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>线性表(1) | qunincey</title>
    <meta name="generator" content="VuePress 1.4.1">
    <link rel="icon" href="/qunincey/bitbug_favicon.ico">
    <meta name="description" content="Learn forever">
    <meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
    <link rel="preload" href="/qunincey/assets/css/0.styles.8897033b.css" as="style"><link rel="preload" href="/qunincey/assets/js/app.2da4be4b.js" as="script"><link rel="preload" href="/qunincey/assets/js/3.21a63061.js" as="script"><link rel="preload" href="/qunincey/assets/js/1.35f57999.js" as="script"><link rel="preload" href="/qunincey/assets/js/12.c09bc5c8.js" as="script"><link rel="prefetch" href="/qunincey/assets/js/10.7ee4a9ce.js"><link rel="prefetch" href="/qunincey/assets/js/11.14c00e30.js"><link rel="prefetch" href="/qunincey/assets/js/13.e742a8cf.js"><link rel="prefetch" href="/qunincey/assets/js/14.f69cc5ca.js"><link rel="prefetch" href="/qunincey/assets/js/15.b3b50902.js"><link rel="prefetch" href="/qunincey/assets/js/16.0ba1e37e.js"><link rel="prefetch" href="/qunincey/assets/js/17.1e5978e2.js"><link rel="prefetch" href="/qunincey/assets/js/18.de8cddd5.js"><link rel="prefetch" href="/qunincey/assets/js/19.ac3236f0.js"><link rel="prefetch" href="/qunincey/assets/js/20.433f6048.js"><link rel="prefetch" href="/qunincey/assets/js/21.f97b8d8d.js"><link rel="prefetch" href="/qunincey/assets/js/22.7c499902.js"><link rel="prefetch" href="/qunincey/assets/js/23.b94dabe7.js"><link rel="prefetch" href="/qunincey/assets/js/24.7eb02bc1.js"><link rel="prefetch" href="/qunincey/assets/js/25.a3f97da3.js"><link rel="prefetch" href="/qunincey/assets/js/26.f29513a8.js"><link rel="prefetch" href="/qunincey/assets/js/27.285bd37d.js"><link rel="prefetch" href="/qunincey/assets/js/28.b24bebcc.js"><link rel="prefetch" href="/qunincey/assets/js/4.0d12002e.js"><link rel="prefetch" href="/qunincey/assets/js/5.c4c899ff.js"><link rel="prefetch" href="/qunincey/assets/js/6.ff3962dc.js"><link rel="prefetch" href="/qunincey/assets/js/7.68f6659a.js"><link rel="prefetch" href="/qunincey/assets/js/8.456f56aa.js"><link rel="prefetch" href="/qunincey/assets/js/9.89b4f9fb.js">
    <link rel="stylesheet" href="/qunincey/assets/css/0.styles.8897033b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-19557b78><div data-v-19557b78><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-19557b78 data-v-19557b78><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-19557b78 data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>qunincey</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>qunincey</span>
            
          <!---->
          2020
        </a></span></div></div> <div class="hide" data-v-19557b78><header class="navbar" data-v-19557b78><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/qunincey/" class="home-link router-link-active"><img src="/qunincey/logo.png" alt="qunincey" class="logo"> <span class="site-name">qunincey</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/qunincey/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qunincey/categories/数据库/" class="nav-link"><i class="iconfont undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/qunincey/categories/java/" class="nav-link"><i class="iconfont undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/qunincey/categories/读书笔记/" class="nav-link"><i class="iconfont undefined"></i>
  读书笔记
</a></li><li class="dropdown-item"><!----> <a href="/qunincey/categories/other/" class="nav-link"><i class="iconfont undefined"></i>
  other
</a></li><li class="dropdown-item"><!----> <a href="/qunincey/categories/vue/" class="nav-link"><i class="iconfont undefined"></i>
  vue
</a></li></ul></div></div><div class="nav-item"><a href="/qunincey/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/qunincey/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/qunincey" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-19557b78></div> <aside class="sidebar" data-v-19557b78><div class="personal-info-wrapper" data-v-b038cec6><img src="/qunincey/avatar.png" alt="author-avatar" class="personal-img" data-v-b038cec6> <h3 class="name" data-v-b038cec6>
    qunincey
  </h3> <div class="num" data-v-b038cec6><div data-v-b038cec6><h3 data-v-b038cec6>16</h3> <h6 data-v-b038cec6>Article</h6></div> <div data-v-b038cec6><h3 data-v-b038cec6>7</h3> <h6 data-v-b038cec6>Tag</h6></div></div> <hr data-v-b038cec6></div> <nav class="nav-links"><div class="nav-item"><a href="/qunincey/" class="nav-link"><i class="iconfont reco-home"></i>
  Home
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-category"></i>
      Category
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/qunincey/categories/数据库/" class="nav-link"><i class="iconfont undefined"></i>
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/qunincey/categories/java/" class="nav-link"><i class="iconfont undefined"></i>
  java
</a></li><li class="dropdown-item"><!----> <a href="/qunincey/categories/读书笔记/" class="nav-link"><i class="iconfont undefined"></i>
  读书笔记
</a></li><li class="dropdown-item"><!----> <a href="/qunincey/categories/other/" class="nav-link"><i class="iconfont undefined"></i>
  other
</a></li><li class="dropdown-item"><!----> <a href="/qunincey/categories/vue/" class="nav-link"><i class="iconfont undefined"></i>
  vue
</a></li></ul></div></div><div class="nav-item"><a href="/qunincey/tag/" class="nav-link"><i class="iconfont reco-tag"></i>
  Tag
</a></div><div class="nav-item"><a href="/qunincey/timeline/" class="nav-link"><i class="iconfont reco-date"></i>
  TimeLine
</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont reco-message"></i>
      Contact
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://github.com/qunincey" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont reco-github"></i>
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>线性表(1)</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/qunincey/views/java/%E7%BA%BF%E6%80%A7%E8%A1%A8.html#定义" class="sidebar-link">定义</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/qunincey/views/java/%E7%BA%BF%E6%80%A7%E8%A1%A8.html#抽象数据结构" class="sidebar-link">抽象数据结构</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/qunincey/views/java/%E7%BA%BF%E6%80%A7%E8%A1%A8.html#java中的实现" class="sidebar-link">Java中的实现</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/qunincey/views/java/%E7%BA%BF%E6%80%A7%E8%A1%A8.html#java8之后推荐的用法" class="sidebar-link">Java8之后推荐的用法</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-19557b78><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>线性表(1)</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>qunincey</span>
            
          <!---->
          2020
        </a></span></div></div> <div data-v-19557b78><main class="page"><div class="page-title" style="display:none;"><h1>线性表(1)</h1> <hr> <div data-v-484a899e><i class="iconfont reco-account" data-v-484a899e><span data-v-484a899e>qunincey</span></i> <i class="iconfont reco-date" data-v-484a899e><span data-v-484a899e>2020-05-21</span></i> <!----> <i class="iconfont reco-tag tags" data-v-484a899e><span class="tag-item" data-v-484a899e>
      java,数据结构和算法
    </span></i></div></div> <div class="theme-reco-content content__default" style="display:none;"><h1 id="线性表（1）"><a href="#线性表（1）" class="header-anchor">#</a> 线性表（1）</h1> <p>线性表几乎是开发中最经常使用的数据结构，在开始学习之前，我想总结一下，为什么我们需要线性表，引用书中的需求，怎么存储班上的所有学生的信息，并且每个人通过报数能够找到下一个人的位置，所以我们需要一种结构来存储一个有序的集合，这个集合的每一个节点必须存储下一个节点的位置(因为我们有查找下一个的需求，线性表才会存储下一个地址)</p> <h2 id="定义"><a href="#定义" class="header-anchor">#</a> 定义</h2> <p>线性表: 零个或多个元素的有限序列，每一个元素都有对应的顺序的。</p> <h2 id="抽象数据结构"><a href="#抽象数据结构" class="header-anchor">#</a> 抽象数据结构</h2> <p>抽象数据结构就是一个数据机构拥有哪些方法，数据的定义是什么，在Java中，我只理解成一个接口，比如所有的ArrayList都实现了List接口，这和list接口就相当于抽象数据结构</p> <h2 id="java中的实现"><a href="#java中的实现" class="header-anchor">#</a> Java中的实现</h2> <p>进入List接口，发现List继承了Collection以及间接集成了Iterable，如下图<br> <img src="data:image/png;base64,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" alt="List继承"></p> <p>Iterable是实现foreach循环的接口,具体的可以直接看文档
<img src="/qunincey/assets/img/foreach.98dad1af.png" alt="iterable"></p> <p>Collection是比较重要的接口，几乎是所有的集合具体实现的父接口，在Java文档中已经有比较详细的介绍，在这里只记录比较关键的点。<br> <a href="https://docs.oracle.com/javase/tutorial/collections/interfaces/collection.html" target="_blank" rel="noopener noreferrer">Java中Collection的总体介绍<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>Collection在循环的时候实现删除元素，在之前有一次我使用for循环和foreach循环的时候，一边循环一边删除时失败了，当时没有深究过这个原因，但今天看文档的时候意外发现，在Collection文档中，已经说明当我们使用foreach循环的时候，使用删除等命令都会引起ConcurrentModificationException错误，现在从源代码的角度看一下是为什么引起这个错误。测试代码如下:</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>a<span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        a<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;3&quot;</span><span class="token punctuation">;</span>
        a<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">;</span>
        a<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">&quot;5&quot;</span><span class="token punctuation">;</span>

        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">String</span> el<span class="token operator">:</span>list<span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                list<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>反编译class文件,发现foreach底层调用了list的iterator方法，返回一个iterator，点击去发现ArrayList里自己实现了iterator类，贴出相对应的代码</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;5&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Iterator</span> var3 <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span><span class="token punctuation">(</span>var3<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> el <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>var3<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>el<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;5&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                list<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>el<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>

        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> cursor <span class="token operator">!=</span> size<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">&quot;unchecked&quot;</span><span class="token punctuation">)</span>
        <span class="token keyword">public</span> <span class="token class-name">E</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> cursor<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> size<span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoSuchElementException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">Object</span><span class="token punctuation">[</span><span class="token punctuation">]</span> elementData <span class="token operator">=</span> <span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>elementData<span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            cursor <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">E</span><span class="token punctuation">)</span> elementData<span class="token punctuation">[</span>lastRet <span class="token operator">=</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>发现在checkForComodification()方法和游标(cursor)超过数组长度的时候都会报ConcurrentModificationException();在这个方法和checkForComodification()打个断点</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>modCount <span class="token operator">!=</span> expectedModCount<span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>然后我们看下remove方法，进入remove方法，发现其核心方法为fastremove，在其方法上打个断点</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">fastRemove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        modCount<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> numMoved <span class="token operator">=</span> size <span class="token operator">-</span> index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>numMoved <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span>
                             numMoved<span class="token punctuation">)</span><span class="token punctuation">;</span>
        elementData<span class="token punctuation">[</span><span class="token operator">--</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// clear to let GC do its work</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>这里面有个modCount++的操作，这个modCount在checkForComodification方法中会引发相关错误，这个modCount是继承AbstractList，进入文档，发现更为详细的信息，下面这段话的大致意思就是这个modCount值时专门用来记录列表修改的次数的，如果发生类似于修改，增加等相关操作，都会使这个数值发生变化，然后就会抛出ConcurrentModificationException这个错误。</p> <p>The number of times this list has been structurally modified. Structural modifications are those that change the size of the list, or otherwise perturb it in such a fashion that iterations in progress may yield incorrect results.
This field is used by the iterator and list iterator implementation returned by the iterator and listIterator methods. If the value of this field changes unexpectedly, the iterator (or list iterator) will throw a ConcurrentModificationException in response to the next, remove, previous, set or add operations. This provides fail-fast behavior, rather than non-deterministic behavior in the face of concurrent modification during iteration.</p> <p>后面又试着debug，发现只有当我把要删除的数字改为4之后就不报错了，也就是说当改为4之后，list的size和游标相当，size原本是3，但是删除一个元素，size变为2，而4的index就为2，hasNext就为false，跳出循环，不在调用next方法，如果把remove缓存add，无论是哪个数字都会报错，原因如上。</p> <p>在文档中也提到了想要一边循环一边删除，必须使用
Iterator，如下代码。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">filter</span><span class="token punctuation">(</span><span class="token class-name">Collection</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">&gt;</span></span> it <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token punctuation">)</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">cond</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            it<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>照例看一下为什么这种写法不会引发上面的问题，先反编译一下class文件。</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">{</span><span class="token string">&quot;3&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;4&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;5&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;5&quot;</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Iterator</span> it <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">while</span><span class="token punctuation">(</span>it<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>it<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                it<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>这里发现最大的区别在于这里调用了iterator的remove方法，看一下代码相关的代码</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>lastRet <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token class-name">ArrayList</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>lastRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
                cursor <span class="token operator">=</span> lastRet<span class="token punctuation">;</span>
                lastRet <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                expectedModCount <span class="token operator">=</span> modCount<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IndexOutOfBoundsException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p>仔细观察，虽然这里也会调用checkForComodification()方法和list的remove方法，但是最后会把modCount的值赋给
expectedModCount，这样就不会引发错误了。</p> <h2 id="java8之后推荐的用法"><a href="#java8之后推荐的用法" class="header-anchor">#</a> Java8之后推荐的用法</h2> <p>Java8后新增了一个removeIf方法，点开之后发现内部的原理也是上面的步骤，但是这里用了lamda表达式，这种写法感觉可以借鉴一下</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">removeIf</span><span class="token punctuation">(</span>s <span class="token operator">-&gt;</span> s<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;4&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">default</span> <span class="token keyword">boolean</span> <span class="token function">removeIf</span><span class="token punctuation">(</span><span class="token class-name">Predicate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span> <span class="token keyword">super</span> <span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> filter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">requireNonNull</span><span class="token punctuation">(</span>filter<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">boolean</span> removed <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">final</span> <span class="token class-name">Iterator</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">E</span><span class="token punctuation">&gt;</span></span> each <span class="token operator">=</span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>each<span class="token punctuation">.</span><span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>filter<span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>each<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                each<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                removed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> removed<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">6/11/2020, 9:24:40 AM</span></div></footer> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-44bd5a18 data-v-44bd5a18><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-44bd5a18><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-44bd5a18></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-44bd5a18></path></svg></div></div></div>
    <script src="/qunincey/assets/js/app.2da4be4b.js" defer></script><script src="/qunincey/assets/js/3.21a63061.js" defer></script><script src="/qunincey/assets/js/1.35f57999.js" defer></script><script src="/qunincey/assets/js/12.c09bc5c8.js" defer></script>
  </body>
</html>
